<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/loaders/GLTFLoader.js"></script>

    <script>
        const container = document.getElementById('brain-viewport');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(35, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.z = 6;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        // Luzes para volume 3D
        scene.add(new THREE.AmbientLight(0xffffff, 0.6));
        const pointLight = new THREE.PointLight(0xe30613, 2);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);

        let brain;
        const loader = new THREE.GLTFLoader();
        
        loader.load('human-brain.glb', (gltf) => {
            brain = gltf.scene;
            brain.scale.set(1.6, 1.6, 1.6);
            brain.traverse(c => {
                if(c.isMesh) {
                    c.material = new THREE.MeshStandardMaterial({
                        color: 0x050000,        // Base escura para destacar a "lava"
                        emissive: 0x880000,     // Vermelho de repouso
                        emissiveIntensity: 0.5,
                        roughness: 0.9,         // Efeito fosco (essencial para não ser lamparina)
                        metalness: 0.0
                    });
                }
            });
            scene.add(brain);
            animate(); // Só começa a animar depois que carrega
        }, undefined, (error) => {
            console.error("Erro ao carregar o modelo:", error);
        });

        // Lógica do Pulso Elétrico (Brasa)
        const idInput = document.getElementById('idInput');
        idInput.addEventListener('input', () => {
            if(brain) {
                brain.traverse(c => {
                    if(c.isMesh) {
                        c.material.emissive.setHex(0xff4500); // Laranja Neon
                        c.material.emissiveIntensity = 10.0;  // Pico de energia
                    }
                });
            }
        });

        function animate() {
            requestAnimationFrame(animate);
            if(brain) {
                brain.rotation.y += 0.005;
                brain.traverse(c => {
                    if(c.isMesh && c.material.emissiveIntensity > 0.5) {
                        // Esfria a sinapse gradualmente
                        c.material.emissiveIntensity *= 0.92;
                        
                        // Transição suave para o vermelho da UNINTA
                        if(c.material.emissiveIntensity < 3.0) {
                            c.material.emissive.setHex(0xe30613);
                        }
                    }
                });
            }
            renderer.render(scene, camera);
        }

        // Ajuste de Janela
        window.addEventListener('resize', () => {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });

        // Função de Login original
        function validarAcesso() {
            const val = idInput.value.toUpperCase();
            if(val === "MATH001" || val.startsWith("PAC")) {
                window.location.href = "unt.html";
            } else {
                alert("ID INVÁLIDO");
            }
        }
    </script>
